<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">
   <head><title>IGNORED</title>
   </head>
   <body>
   	  
      <ui:composition template="../templates/user_layout.xhtml">
         <ui:define name="content">
         <h:form id="reservationsForm">
         	<p:growl id="growl" showDetail="false"  />

			
			<h:panelGrid columns="4">
				<h:outputText value="#{reservationsBBean.communityItem.name}" />
				(<h:outputText value="#{reservationsBBean.communityItem.zipcode}" />)
				
       		</h:panelGrid>
			<p:dataList id="activeReservationsTable" var="reservation"
				value="#{reservationsBBean.activeReservations}">
				#{reservation.type} #{reservation.name} #{reservation.date} #{reservation.fromTime}-#{reservation.toTime}
			</p:dataList>
		
		<p:separator style="clear:right;" />
		
    	
    	
    	#{msgs['reservations.new']}
    	<h:panelGrid columns="3" style="margin-bottom:10px" cellpadding="5">
        	<p:calendar id="inline" locale="es" value="#{reservationsBBean.newReservationDate}" mode="inline" />
        	<p:selectOneRadio id="types" value="#{reservationsBBean.rsrcTypeSelected.id}"  layout="grid" columns="2">
            	<f:selectItems value="#{reservationsBBean.rsrcTypesList}" 
            		var="rsrcType" 
            		itemLabel="#{rsrcType.description}" 
            		itemValue="#{rsrcType.id}" />
        	</p:selectOneRadio>
        	<p:commandButton  
				icon="ui-icon-search" value="#{msgs['reservations.search']}">
    		</p:commandButton>
    	</h:panelGrid>
    	
    	<!-- Calendario de nueva reserva -->
    	<h:panelGrid id="timetable_date" style="float:right;" columns="2">
    		#{reservationsBBean.reservationDateString}
    		#{reservationsBBean.rsrcTypeSelected.description}.
    	</h:panelGrid>
    	 <br/>   	 	 
    	<ui:repeat id="timetable" style="clear:right;" value="#{timeTableBBean.timeTable}" var="rsrc">
    		#{rsrc.name}
    		<h:panelGrid columns="7">
    			<ui:repeat value="#{rsrc.dailySchedule}" var="scheduleUnit">
    				<p:commandButton
    					icon="#{scheduleUnit.icon}" 	
    					value="#{scheduleUnit.output}"	
    					update="@this :reservationsForm:growl :reservationsForm:activeReservationsTable"
    					actionListener="#{timeTableCBean.reserve(rsrc,scheduleUnit)}"
						/> 	 
    	    
    			</ui:repeat>
    		</h:panelGrid>
		</ui:repeat>
    	
    	<p:dialog
			header="#{msgs['reservations.cancel_confirm_header']}"
			styleClass="text-left" widgetVar="summaryConfirmDialog">
			<p:outputPanel id="confirm_remove" styleClass="confirm-dialog-text-container">
				<p:outputPanel styleClass="ui-icon ui-confirm-dialog-severity ui-icon-alert display-inline-block">
				</p:outputPanel>
      			#{msgs['reservations.cancel_confirm_msg']} 
   			</p:outputPanel>
			<p:commandButton value="#{msgs['reservations.yes']}"
				update=":reservationsForm:activeReservationsTable :reservationsForm" 
				onstart="setUpOnStart();"
				oncomplete="setUpOnComplete();"
				actionListener="#{reservationsCBean.cancelReservation}"
				icon="ui-icon-check" />
			<p:commandButton value="#{msgs['reservations.no']}"
				onclick="PF('summaryConfirmDialog').hide();" type="button"
				icon="ui-icon-close" />
		</p:dialog>
    	<br/>
    	<h:panelGrid style="float:right;" columns="1">
			<p:clock pattern="HH:mm:ss" mode="server" />
		</h:panelGrid>
		<!--   <h:panelGroup binding="#{myReservations.dynamicDataTableGroup}" /> 
        
           <p:commandLink styleClass="label" value="#{msgs.new_reservation}" action="#{myReservations.reserve}"/>
           -->
           </h:form>
         </ui:define>
      </ui:composition>
   </body>
</html>